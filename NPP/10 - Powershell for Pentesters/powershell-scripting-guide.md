# Windows PowerShell Scripting Guide

## Displaying Output

To write text to the screen, use:
```powershell
echo "Hello World"
Write-Host "Hello World"
Write-Output "Hello World"
```

## Script Files

PowerShell scripts use the `.ps1` extension.

## Command Substitution

You can embed commands inside strings using `$()`:
```powershell
echo "My current directory is: $(Get-Location)"
```

Note: `pwd` also works similarly to `Get-Location`.

## Variables

Declare a variable by assigning a value:
```powershell
$variable = "value"
```

Display a variable:
```powershell
echo "Scanning the host: $ip"
```

## Searching Strings

PowerShell equivalent of `grep` is `Select-String`:
```powershell
Select-String "bytes=32"
```

## Working with Parameters

Use `Param()` to define parameters for your scripts:
```powershell
Param($parameter)
```

## Reading User Input

Use `Read-Host` to get input:
```powershell
$var = Read-Host "Enter your input"
```

## Finding Commands

Search for commands:
```powershell
Get-Command
```

Search specifically by string:
```powershell
Get-Command | Select-String "string"
```

Get help for a command:
```powershell
Get-Help <command>
```

## Network Tests

Traceroute equivalent:
```powershell
Test-NetConnection google.com.br -Traceroute
```

Check if a port is open:
```powershell
Test-NetConnection google.com.br -Port 22
```

Script example to validate a port:
```powershell
if (Test-NetConnection google.com.br -Port 443 -WarningAction SilentlyContinue -InformationLevel Quiet) {
    echo "Port Open"
} else {
    echo "Port Closed"
}
```

## Working with Web Requests

Download a webpage:
```powershell
Invoke-WebRequest businesscorp.com.br -Outfile businesscorp.txt
```

Change the HTTP method:
```powershell
Invoke-WebRequest businesscorp.com.br -Method OPTIONS
```

Accessing specific parts of the response:
```powershell
(Invoke-WebRequest businesscorp.com.br).Content
(Invoke-WebRequest businesscorp.com.br).StatusCode
(Invoke-WebRequest businesscorp.com.br).Links
(Invoke-WebRequest businesscorp.com.br).Headers.Server
```
